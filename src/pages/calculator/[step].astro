---
/**
 * CALCULATOR STEP PAGE
 *
 * Dynamic routing for calculator steps
 */

import LayoutCalculator from '@/components/calculator/layout-calculator.astro';
import { getStepById, CALCULATOR_STEPS } from '@/lib/core/calculator/config';
import { CalculatorStepRenderer } from '@/components/calculator/CalculatorStepRenderer';

// Get step from URL
const { step } = Astro.params;

// Validate step
const stepConfig = getStepById(step || '');

if (!stepConfig) {
  return Astro.redirect('/404');
}

// Get step order for progress
const stepOrder = stepConfig.order;

export function getStaticPaths() {
  return CALCULATOR_STEPS.map((step) => ({
    params: { step: step.id },
  }));
}
---

<LayoutCalculator
  title={stepConfig.title.en}
  description={stepConfig.description?.en}
  currentStep={stepOrder}
>
  <CalculatorStepRenderer client:load stepId={step!} />
</LayoutCalculator>
